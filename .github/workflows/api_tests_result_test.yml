name: Testing workflow outputs

on: 
  workflow_run:
    workflows: [API tests - OUTPUTS]
    types: [completed]

jobs:
  jdownload-artifact-and-get-repository-name:
    name: Display results
    runs-on: ubuntu-latest
    env:
      TENDERLY_PROJECT: ${{ secrets.TENDERLY_PROJECT }}
      TENDERLY_USER: ${{ secrets.TENDERLY_USER }}
      TENDERLY_ACCESS_KEY: ${{ secrets.TENDERLY_ACCESS_KEY }}
    steps:
      - run: echo 'RUN ID --> ${{ github.event.workflow_run.id }}'
      - name: Download artifact with trigger repository name
        uses: actions/download-artifact@v4
        with:
          name: nombre_de_paco
          github-token: ${{ github.token }}
          repository: ${{ github.repository }}
          run-id: ${{ github.event.workflow_run.id }}
      - name: Print the final result
        shell: bash
        run: |
          value=`cat mi_nombre.txt`
          echo El nombre es $value
      - name: Set the value
        id: step_one
        run: |
          value=`cat mi_nombre.txt`
          echo "action_state=$value" >> "$GITHUB_ENV"
      - name: PRINT the value
        run: |
          echo "La ENV variable es --> ${{ env.action_state }}"
      - name: "Manda a e2e-tests"
        if: ${{ env.action_state == 'SOY_PACO' }}
        run: echo 'Si soy PAco!!!'
      - name: "Manda a monorepo"
        if: ${{ env.action_state == 'SOY_PACO' }}
        run: echo 'NO soy PAco :( '


      